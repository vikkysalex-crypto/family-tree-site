{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/okevi/Desktop/Developments/family-tree-site/app/dashboard/family-tree/page.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState, useEffect } from \"react\"\r\nimport { supabase } from \"@/lib/supabase/client\"\r\nimport { useAuth } from \"@/providers/auth-provider\"\r\nimport { useRouter } from \"next/navigation\"\r\nimport { Button } from \"@/components/ui/button\"\r\n\r\nexport default function AddFamilyMember() {\r\n  const { user } = useAuth()\r\n  const router = useRouter()\r\n\r\n  const [form, setForm] = useState({\r\n    firstName: \"\",\r\n    lastName: \"\",\r\n    otherName: \"\",\r\n    dob: \"\",\r\n    relationship: \"\",\r\n  })\r\n  const [isLoading, setIsLoading] = useState(false)\r\n  const [error, setError] = useState(\"\")\r\n  const [loadingUser, setLoadingUser] = useState(true)\r\n\r\n  // Wait for user to load\r\n  useEffect(() => {\r\n    if (user) setLoadingUser(false)\r\n  }, [user])\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\r\n    setForm({ ...form, [e.target.name]: e.target.value })\r\n  }\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault()\r\n    setError(\"\")\r\n\r\n    if (!user) {\r\n      setError(\"Loading user info, please wait...\")\r\n      return\r\n    }\r\n\r\n    const { firstName, lastName, relationship, otherName, dob } = form\r\n\r\n    if (!firstName || !lastName || !relationship) {\r\n      setError(\"Please fill in First Name, Last Name, and Relationship.\")\r\n      return\r\n    }\r\n\r\n    setIsLoading(true)\r\n\r\n    const { error: dbError } = await supabase.from(\"family_members\").insert([\r\n      {\r\n        user_id: user.id, // âœ… guaranteed to exist now\r\n        first_name: firstName,\r\n        last_name: lastName,\r\n        other_name: otherName || null,\r\n        dob: dob || null,\r\n        relationship,\r\n      },\r\n    ])\r\n\r\n    setIsLoading(false)\r\n\r\n    if (dbError) {\r\n      setError(dbError.message)\r\n      return\r\n    }\r\n\r\n    router.push(\"/dashboard/family-tree\")\r\n  }\r\n\r\n  if (loadingUser) return <p className=\"p-6\">Loading user information...</p>\r\n\r\n  return (\r\n    <div className=\"max-w-lg mx-auto p-8 bg-white rounded-xl shadow mt-12\">\r\n      <h1 className=\"text-2xl font-bold text-center mb-6\">Add Family Member</h1>\r\n\r\n      {error && (\r\n        <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-2 rounded mb-4\">\r\n          {error}\r\n        </div>\r\n      )}\r\n\r\n      <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n          <div>\r\n            <label className=\"block text-sm font-medium mb-1\">First Name</label>\r\n            <input\r\n              name=\"firstName\"\r\n              value={form.firstName}\r\n              onChange={handleChange}\r\n              type=\"text\"\r\n              placeholder=\"John\"\r\n              className=\"w-full border px-3 py-2 rounded focus:ring-2 focus:ring-primary\"\r\n              required\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium mb-1\">Last Name</label>\r\n            <input\r\n              name=\"lastName\"\r\n              value={form.lastName}\r\n              onChange={handleChange}\r\n              type=\"text\"\r\n              placeholder=\"Doe\"\r\n              className=\"w-full border px-3 py-2 rounded focus:ring-2 focus:ring-primary\"\r\n              required\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium mb-1\">Other Name</label>\r\n          <input\r\n            name=\"otherName\"\r\n            value={form.otherName}\r\n            onChange={handleChange}\r\n            type=\"text\"\r\n            placeholder=\"Optional\"\r\n            className=\"w-full border px-3 py-2 rounded focus:ring-2 focus:ring-primary\"\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium mb-1\">Date of Birth</label>\r\n          <input\r\n            name=\"dob\"\r\n            value={form.dob}\r\n            onChange={handleChange}\r\n            type=\"date\"\r\n            className=\"w-full border px-3 py-2 rounded focus:ring-2 focus:ring-primary\"\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium mb-1\">Relationship</label>\r\n          <select\r\n            name=\"relationship\"\r\n            value={form.relationship}\r\n            onChange={handleChange}\r\n            className=\"w-full border px-3 py-2 rounded focus:ring-2 focus:ring-primary\"\r\n            required\r\n          >\r\n            <option value=\"\">Select relationship</option>\r\n            <option value=\"father\">Father</option>\r\n            <option value=\"mother\">Mother</option>\r\n            <option value=\"grandparent\">Grandparent</option>\r\n            <option value=\"child\">Child</option>\r\n            <option value=\"sibling\">Sibling</option>\r\n          </select>\r\n        </div>\r\n\r\n        <Button type=\"submit\" className=\"w-full mt-2\" disabled={isLoading}>\r\n          {isLoading ? \"Adding...\" : \"Add Member\"}\r\n        </Button>\r\n      </form>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}}]
}