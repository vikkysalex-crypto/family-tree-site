{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/okevi/Desktop/Developments/family-tree-site/app/dashboard/family-tree/page.tsx"],"sourcesContent":["// \"use client\"\r\n\r\n// import { useState } from \"react\"\r\n// import { supabase } from \"@/lib/supabase/client\"\r\n// import { useAuth } from \"@/providers/auth-provider\"\r\n// import { useRouter } from \"next/navigation\"\r\n// import { Button } from \"@/components/ui/button\"\r\n\r\n// export default function AddFamilyMember() {\r\n//   const { user } = useAuth()\r\n//   const router = useRouter()\r\n\r\n//   const [form, setForm] = useState({\r\n//     firstName: \"\",\r\n//     lastName: \"\",\r\n//     otherName: \"\",\r\n//     dob: \"\",\r\n//     relationship: \"\",\r\n//   })\r\n\r\n//   const [isLoading, setIsLoading] = useState(false)\r\n//   const [error, setError] = useState(\"\")\r\n\r\n//   const handleChange = (\r\n//     e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>\r\n//   ) => {\r\n//     setForm({ ...form, [e.target.name]: e.target.value })\r\n//   }\r\n\r\n//   const handleSubmit = async (e: React.FormEvent) => {\r\n//     e.preventDefault()\r\n//     setError(\"\")\r\n\r\n//     if (!user?.id) {\r\n//       setError(\"Authentication error. Please refresh the page.\")\r\n//       return\r\n//     }\r\n\r\n//     const { firstName, lastName, relationship, otherName, dob } = form\r\n\r\n//     if (!firstName || !lastName || !relationship) {\r\n//       setError(\"First name, last name, and relationship are required.\")\r\n//       return\r\n//     }\r\n\r\n//     setIsLoading(true)\r\n\r\n//     const { error: dbError } = await supabase\r\n//       .from(\"family_members\")\r\n//       .insert({\r\n//         user_id: user.id,\r\n//         first_name: firstName,\r\n//         last_name: lastName,\r\n//         other_name: otherName || null,\r\n//         dob: dob || null,\r\n//         relationship,\r\n//       })\r\n\r\n//     setIsLoading(false)\r\n\r\n//     if (dbError) {\r\n//       setError(dbError.message)\r\n//       return\r\n//     }\r\n\r\n//     router.push(\"/dashboard/family-tree\")\r\n//   }\r\n\r\n//   return (\r\n//     <div className=\"max-w-xl mx-auto mt-14 p-8 bg-white rounded-2xl shadow-sm\">\r\n//       <h1 className=\"text-2xl font-semibold mb-6 text-center\">\r\n//         Add Family Member\r\n//       </h1>\r\n\r\n//       {error && (\r\n//         <div className=\"mb-4 rounded-lg bg-red-50 border border-red-200 px-4 py-3 text-sm text-red-700\">\r\n//           {error}\r\n//         </div>\r\n//       )}\r\n\r\n//       <form onSubmit={handleSubmit} className=\"space-y-5\">\r\n//         <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n//           <input\r\n//             name=\"firstName\"\r\n//             placeholder=\"First name\"\r\n//             value={form.firstName}\r\n//             onChange={handleChange}\r\n//             className=\"w-full rounded-lg border px-4 py-3 focus:ring-2 focus:ring-primary\"\r\n//             required\r\n//           />\r\n\r\n//           <input\r\n//             name=\"lastName\"\r\n//             placeholder=\"Last name\"\r\n//             value={form.lastName}\r\n//             onChange={handleChange}\r\n//             className=\"w-full rounded-lg border px-4 py-3 focus:ring-2 focus:ring-primary\"\r\n//             required\r\n//           />\r\n//         </div>\r\n\r\n//         <input\r\n//           name=\"otherName\"\r\n//           placeholder=\"Other name (optional)\"\r\n//           value={form.otherName}\r\n//           onChange={handleChange}\r\n//           className=\"w-full rounded-lg border px-4 py-3 focus:ring-2 focus:ring-primary\"\r\n//         />\r\n\r\n//         <input\r\n//           type=\"date\"\r\n//           name=\"dob\"\r\n//           value={form.dob}\r\n//           onChange={handleChange}\r\n//           className=\"w-full rounded-lg border px-4 py-3 focus:ring-2 focus:ring-primary\"\r\n//         />\r\n\r\n//         <select\r\n//           name=\"relationship\"\r\n//           value={form.relationship}\r\n//           onChange={handleChange}\r\n//           className=\"w-full rounded-lg border px-4 py-3 focus:ring-2 focus:ring-primary\"\r\n//           required\r\n//         >\r\n//           <option value=\"\">Select relationship</option>\r\n//           <option value=\"father\">Father</option>\r\n//           <option value=\"mother\">Mother</option>\r\n//           <option value=\"grandparent\">Grandparent</option>\r\n//           <option value=\"child\">Child</option>\r\n//           <option value=\"sibling\">Sibling</option>\r\n//         </select>\r\n\r\n//         <Button\r\n//           type=\"submit\"\r\n//           className=\"w-full py-3 text-base\"\r\n//           disabled={isLoading}\r\n//         >\r\n//           {isLoading ? \"Saving...\" : \"Add Family Member\"}\r\n//         </Button>\r\n//       </form>\r\n//     </div>\r\n//   )\r\n// }\r\n\r\n\r\n\r\n\r\n\r\n\"use client\"\r\n\r\nimport { useEffect, useState } from \"react\"\r\nimport { supabase } from \"@/lib/supabase/client\"\r\nimport { Button } from \"@/components/ui/button\"\r\n\r\ntype FamilyMember = {\r\n  id: string\r\n  first_name: string\r\n  last_name: string\r\n  other_name: string | null\r\n  dob: string | null\r\n  relationship: string\r\n}\r\n\r\nexport default function FamilyTreePage() {\r\n  const [userId, setUserId] = useState<string | null>(null)\r\n  const [members, setMembers] = useState<FamilyMember[]>([])\r\n  const [loading, setLoading] = useState(false)\r\n  const [error, setError] = useState(\"\")\r\n\r\n  const [form, setForm] = useState({\r\n    firstName: \"\",\r\n    lastName: \"\",\r\n    otherName: \"\",\r\n    dob: \"\",\r\n    relationship: \"\",\r\n  })\r\n\r\n  /* ---------------- LOAD AUTH USER ---------------- */\r\n  useEffect(() => {\r\n    const loadUser = async () => {\r\n      const { data } = await supabase.auth.getSession()\r\n\r\n      if (data.session?.user) {\r\n        setUserId(data.session.user.id)\r\n        fetchMembers(data.session.user.id)\r\n      }\r\n    }\r\n\r\n    loadUser()\r\n  }, [])\r\n\r\n  /* ---------------- FETCH FAMILY MEMBERS ---------------- */\r\n  const fetchMembers = async (uid: string) => {\r\n    const { data, error } = await supabase\r\n      .from(\"family_members\")\r\n      .select(\"*\")\r\n      .eq(\"user_id\", uid)\r\n      .order(\"created_at\", { ascending: false })\r\n\r\n    if (!error && data) {\r\n      setMembers(data)\r\n    }\r\n  }\r\n\r\n  /* ---------------- HANDLE FORM INPUT ---------------- */\r\n  const handleChange = (\r\n    e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>\r\n  ) => {\r\n    setForm({ ...form, [e.target.name]: e.target.value })\r\n  }\r\n\r\n  /* ---------------- SUBMIT ---------------- */\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault()\r\n    setError(\"\")\r\n\r\n    if (!userId) {\r\n      setError(\"Please wait, loading user...\")\r\n      return\r\n    }\r\n\r\n    const { firstName, lastName, relationship, otherName, dob } = form\r\n\r\n    if (!firstName || !lastName || !relationship) {\r\n      setError(\"First name, last name, and relationship are required.\")\r\n      return\r\n    }\r\n\r\n    setLoading(true)\r\n\r\n    const { error } = await supabase.from(\"family_members\").insert({\r\n      user_id: userId,\r\n      first_name: firstName,\r\n      last_name: lastName,\r\n      other_name: otherName || null,\r\n      dob: dob || null,\r\n      relationship,\r\n    })\r\n\r\n    setLoading(false)\r\n\r\n    if (error) {\r\n      setError(error.message)\r\n      return\r\n    }\r\n\r\n    // Reset form\r\n    setForm({\r\n      firstName: \"\",\r\n      lastName: \"\",\r\n      otherName: \"\",\r\n      dob: \"\",\r\n      relationship: \"\",\r\n    })\r\n\r\n    // Refresh list\r\n    fetchMembers(userId)\r\n  }\r\n\r\n  return (\r\n    <div className=\"max-w-5xl mx-auto mt-14 px-4\">\r\n      {/* ================= ADD FORM ================= */}\r\n      <div className=\"bg-white p-8 rounded-2xl shadow-sm mb-10\">\r\n        <h1 className=\"text-2xl font-semibold mb-6 text-center\">\r\n          Add Family Member\r\n        </h1>\r\n\r\n        {error && (\r\n          <div className=\"mb-4 rounded-lg bg-red-50 border border-red-200 px-4 py-3 text-sm text-red-700\">\r\n            {error}\r\n          </div>\r\n        )}\r\n\r\n        <form onSubmit={handleSubmit} className=\"space-y-5\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n            <input\r\n              name=\"firstName\"\r\n              placeholder=\"First name\"\r\n              value={form.firstName}\r\n              onChange={handleChange}\r\n              className=\"w-full rounded-lg border px-4 py-3\"\r\n              required\r\n            />\r\n\r\n            <input\r\n              name=\"lastName\"\r\n              placeholder=\"Last name\"\r\n              value={form.lastName}\r\n              onChange={handleChange}\r\n              className=\"w-full rounded-lg border px-4 py-3\"\r\n              required\r\n            />\r\n          </div>\r\n\r\n          <input\r\n            name=\"otherName\"\r\n            placeholder=\"Other name (optional)\"\r\n            value={form.otherName}\r\n            onChange={handleChange}\r\n            className=\"w-full rounded-lg border px-4 py-3\"\r\n          />\r\n\r\n          <input\r\n            type=\"date\"\r\n            name=\"dob\"\r\n            value={form.dob}\r\n            onChange={handleChange}\r\n            className=\"w-full rounded-lg border px-4 py-3\"\r\n          />\r\n\r\n          <select\r\n            name=\"relationship\"\r\n            value={form.relationship}\r\n            onChange={handleChange}\r\n            className=\"w-full rounded-lg border px-4 py-3\"\r\n            required\r\n          >\r\n            <option value=\"\">Select relationship</option>\r\n            <option value=\"father\">Father</option>\r\n            <option value=\"mother\">Mother</option>\r\n            <option value=\"grandparent\">Grandparent</option>\r\n            <option value=\"child\">Child</option>\r\n            <option value=\"sibling\">Sibling</option>\r\n          </select>\r\n\r\n          <Button\r\n            type=\"submit\"\r\n            className=\"w-full py-3\"\r\n            disabled={loading || !userId}\r\n          >\r\n            {!userId\r\n              ? \"Loading user...\"\r\n              : loading\r\n              ? \"Saving...\"\r\n              : \"Add Family Member\"}\r\n          </Button>\r\n        </form>\r\n      </div>\r\n\r\n      {/* ================= DISPLAY MEMBERS ================= */}\r\n      <div>\r\n        <h2 className=\"text-xl font-semibold mb-4\">\r\n          Your Family Members\r\n        </h2>\r\n\r\n        {members.length === 0 && (\r\n          <p className=\"text-gray-500\">\r\n            No family members added yet.\r\n          </p>\r\n        )}\r\n\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n          {members.map((member) => (\r\n            <div\r\n              key={member.id}\r\n              className=\"rounded-xl border bg-white p-5 shadow-sm\"\r\n            >\r\n              <h3 className=\"font-semibold text-lg\">\r\n                {member.first_name}{\" \"}\r\n                {member.other_name && member.other_name + \" \"}\r\n                {member.last_name}\r\n              </h3>\r\n\r\n              <p className=\"text-sm text-gray-600 capitalize\">\r\n                {member.relationship}\r\n              </p>\r\n\r\n              {member.dob && (\r\n                <p className=\"text-sm text-gray-500 mt-1\">\r\n                  DOB: {member.dob}\r\n                </p>\r\n              )}\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}}]
}